import{i as R,Q as F,T as z,c as y,w as n,o as c,a as d,u as e,Z as D,A as q,h as p,t as a,k as C,G as h,m as N,v as U,f as o,V as L,E as M,z as P,y as b,d as m,l as A,p as G,e as v,Y as K,J as Y,q as w}from"./app-BpXjbCMW.js";import{L as H}from"./main-B236rcsx.js";import{P as J}from"./page-header-DEyyf2_K.js";import{_ as Q}from"./card-header-Ct8audyA.js";import{S as _}from"./sweetalert2.all-BXeenfYg.js";import"./simplebar-vue.esm-Ds3EkmLx.js";import"./logo-dark-BbIT5rJd.js";import"./logo-light-Bc94pPwb.js";import"./us-DIspYScJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"mb-4"},O={class:"mb-3"},W={class:"form-label"},X={class:"mb-3"},ee={class:"form-label"},te={value:"all"},se={value:"pending"},ae={value:"approved"},oe={value:"rejected"},ne={value:"cancelled"},re={class:"mb-3"},le=o("i",{class:"ri-search-line me-1"},null,-1),de=o("i",{class:"ri-refresh-line me-1"},null,-1),ie={key:0},ce={class:"mb-3"},ue={class:"text-muted"},me={class:"table-responsive"},pe={key:0},_e=o("br",null,null,-1),fe={class:"text-muted"},he={key:1,class:"text-muted"},be={key:0},we=o("br",null,null,-1),ye={class:"text-muted"},ve=o("br",null,null,-1),ge={class:"text-muted"},ke={key:1,class:"text-muted"},xe={class:"fw-bold text-primary"},qe={key:0,class:"fw-bold text-danger"},Ce={key:1,class:"text-muted"},Be={key:0},Se=o("br",null,null,-1),Ve={class:"text-muted"},je={key:1,class:"text-muted"},Te={key:0,class:"d-flex justify-content-center mt-3"},$e={key:1,class:"text-center py-4"},Ee={class:"text-muted"},Ke={__name:"Index",setup(Ie){const{t}=R(),{withdrawalRequests:u,status:f,keyword:B}=F().props,r=z({page:1,status:!f||f==="0"||f===0||f===""?"all":f,keyword:B||""}),S=(l,i)=>{r.page=i||r.page;const s={};r.status&&r.status!=="all"&&(s.status=r.status),r.keyword&&(s.keyword=r.keyword),r.get(route("admin.withdrawal-requests.index"),s,{preserveState:!0})},g=()=>{r.page=1;const l={};r.status&&r.status!=="all"&&(l.status=r.status),r.keyword&&(l.keyword=r.keyword),r.get(route("admin.withdrawal-requests.index"),l,{preserveState:!0})},V=()=>{r.status="all",r.keyword="",r.page=1,r.get(route("admin.withdrawal-requests.index"),{},{preserveState:!0})},k=l=>l?new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",x=l=>parseFloat(l||0).toFixed(2),j=l=>({pending:"warning",approved:"success",rejected:"danger",cancelled:"secondary"})[l]||"secondary",T=l=>({pending:t("t-pending"),approved:t("t-approved"),rejected:t("t-rejected"),cancelled:t("t-cancelled")})[l]||l,$=l=>{_.fire({title:t("t-approve-request"),html:`
            <div class="text-start">
                <label class="form-label">${t("t-admin-notes")} (${t("t-note-optional")})</label>
                <textarea id="admin-notes" class="form-control" rows="3" placeholder="${t("t-note-optional")}"></textarea>
            </div>
        `,icon:"question",showCancelButton:!0,confirmButtonColor:"#28a745",cancelButtonColor:"#6c757d",confirmButtonText:t("t-approve"),cancelButtonText:t("t-cancel")||"إلغاء",preConfirm:()=>({admin_notes:document.getElementById("admin-notes").value})}).then(i=>{i.isConfirmed&&w.post(route("admin.withdrawal-requests.approve",l),{admin_notes:i.value.admin_notes},{preserveState:!1,preserveScroll:!0,onSuccess:()=>{_.fire({icon:"success",title:t("t-success"),text:t("t-request-approved"),timer:2e3,showConfirmButton:!1}).then(()=>{w.reload({only:["withdrawalRequests","status","keyword"]})})},onError:s=>{_.fire(t("t-error"),s.message||t("t-an-error-occurred"),"error")}})})},E=l=>{_.fire({title:t("t-reject-request"),html:`
            <div class="text-start">
                <label class="form-label">${t("t-admin-notes")} *</label>
                <textarea id="admin-notes" class="form-control" rows="3" placeholder="${t("t-enter-rejection-reason")}" required></textarea>
            </div>
        `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#dc3545",cancelButtonColor:"#6c757d",confirmButtonText:t("t-reject"),cancelButtonText:t("t-cancel")||"إلغاء",inputValidator:i=>{if(!document.getElementById("admin-notes").value.trim())return t("t-notes-required")},preConfirm:()=>{const i=document.getElementById("admin-notes").value.trim();return i?{admin_notes:i}:(_.showValidationMessage(t("t-notes-required")),!1)}}).then(i=>{i.isConfirmed&&w.post(route("admin.withdrawal-requests.reject",l),{admin_notes:i.value.admin_notes},{preserveState:!1,preserveScroll:!0,onSuccess:()=>{_.fire({icon:"success",title:t("t-success"),text:t("t-request-rejected"),timer:2e3,showConfirmButton:!1}).then(()=>{w.reload({only:["withdrawalRequests","status","keyword"]})})},onError:s=>{_.fire(t("t-error"),s.message||t("t-an-error-occurred"),"error")}})})};return(l,i)=>(c(),y(H,null,{default:n(()=>[d(e(D),{title:e(t)("t-withdrawal-requests")},null,8,["title"]),d(J,{title:e(t)("t-withdrawal-requests"),pageTitle:e(t)("t-dashboard")},{actions:n(()=>[d(e(q),{href:l.route("admin.users.index"),class:"btn btn-outline-primary"},{default:n(()=>[p(a(e(t)("t-back")),1)]),_:1},8,["href"])]),_:1},8,["title","pageTitle"]),d(e(Y),{fluid:""},{default:n(()=>[d(e(C),null,{default:n(()=>[d(e(h),{lg:"12"},{default:n(()=>[d(e(N),{"no-body":""},{default:n(()=>[d(Q,{title:e(t)("t-withdrawal-requests")},null,8,["title"]),d(e(U),null,{default:n(()=>[o("div",Z,[d(e(C),null,{default:n(()=>[d(e(h),{md:"4"},{default:n(()=>[o("div",O,[o("label",W,a(e(t)("t-search-by-name")),1),d(e(L),{modelValue:e(r).keyword,"onUpdate:modelValue":i[0]||(i[0]=s=>e(r).keyword=s),type:"text",placeholder:e(t)("t-reference-id-name-phone"),onKeyup:M(g,["enter"])},null,8,["modelValue","placeholder"])])]),_:1}),d(e(h),{md:"3"},{default:n(()=>[o("div",X,[o("label",ee,a(e(t)("t-filter-by-status")),1),d(e(P),{modelValue:e(r).status,"onUpdate:modelValue":i[1]||(i[1]=s=>e(r).status=s)},{default:n(()=>[o("option",te,a(e(t)("t-all")),1),o("option",se,a(e(t)("t-pending")),1),o("option",ae,a(e(t)("t-approved")),1),o("option",oe,a(e(t)("t-rejected")),1),o("option",ne,a(e(t)("t-cancelled")),1)]),_:1},8,["modelValue"])])]),_:1}),d(e(h),{md:"5",class:"d-flex align-items-end"},{default:n(()=>[o("div",re,[d(e(b),{variant:"primary",onClick:g,class:"me-2"},{default:n(()=>[le,p(" "+a(e(t)("t-apply-filters")),1)]),_:1}),d(e(b),{variant:"outline-primary",onClick:V},{default:n(()=>[de,p(" "+a(e(t)("t-reset")),1)]),_:1})])]),_:1})]),_:1})]),e(u)&&e(u).data&&e(u).data.length>0?(c(),m("div",ie,[o("div",ce,[o("span",ue,[p(a(e(t)("t-total-requests"))+": ",1),o("strong",null,a(e(u).total),1)])]),o("div",me,[d(e(A),{striped:"",hover:"",items:e(u).data,fields:[{key:"row_number",label:"#",sortable:!1},{key:"user",label:e(t)("t-user")||"المستخدم",sortable:!1},{key:"bank_account",label:e(t)("t-bank-account"),sortable:!1},{key:"amount",label:e(t)("t-amount"),sortable:!0},{key:"fee",label:e(t)("t-fee"),sortable:!0},{key:"status",label:e(t)("t-status"),sortable:!0},{key:"created_at",label:e(t)("t-created-at"),sortable:!0},{key:"admin",label:e(t)("t-admin")||"من قبل",sortable:!1},{key:"actions",label:e(t)("t-actions")}],class:"table-nowrap"},{"cell(row_number)":n(({index:s})=>[p(a((e(u).current_page-1)*e(u).per_page+s+1),1)]),"cell(user)":n(({item:s})=>[s.user?(c(),m("div",pe,[o("strong",null,a(s.user.name),1),_e,o("small",fe,a(s.user.phone),1)])):(c(),m("span",he,"-"))]),"cell(bank_account)":n(({item:s})=>[s.bank_account?(c(),m("div",be,[o("strong",null,a(s.bank_account.bank_name),1),we,o("small",ye,a(s.bank_account.account_number),1),ve,o("small",ge,a(s.bank_account.account_holder_name),1)])):(c(),m("span",ke,"-"))]),"cell(amount)":n(({item:s})=>[o("span",xe,a(x(s.amount))+" "+a(e(t)("t-points")||"نقطة"),1)]),"cell(fee)":n(({item:s})=>[s.fee>0?(c(),m("span",qe,a(x(s.fee))+" "+a(e(t)("t-points")||"نقطة"),1)):(c(),m("span",Ce,"-"))]),"cell(status)":n(({item:s})=>[d(e(G),{variant:j(s.status)},{default:n(()=>[p(a(T(s.status)),1)]),_:2},1032,["variant"])]),"cell(created_at)":n(({item:s})=>[p(a(k(s.created_at)),1)]),"cell(admin)":n(({item:s})=>[s.admin?(c(),m("div",Be,[o("strong",null,a(s.admin.name),1),Se,o("small",Ve,a(k(s.approved_at||s.rejected_at)),1)])):(c(),m("span",je,"-"))]),"cell(actions)":n(({item:s})=>[d(e(q),{href:l.route("admin.withdrawal-requests.show",s.id),class:"btn btn-info btn-sm me-1"},{default:n(()=>[p(a(e(t)("t-view")),1)]),_:2},1032,["href"]),s.status==="pending"?(c(),y(e(b),{key:0,variant:"success",size:"sm",class:"me-1",onClick:I=>$(s.id)},{default:n(()=>[p(a(e(t)("t-approve")),1)]),_:2},1032,["onClick"])):v("",!0),s.status==="pending"?(c(),y(e(b),{key:1,variant:"danger",size:"sm",onClick:I=>E(s.id)},{default:n(()=>[p(a(e(t)("t-reject")),1)]),_:2},1032,["onClick"])):v("",!0)]),_:1},8,["items","fields"])]),e(u).last_page>1?(c(),m("div",Te,[d(e(K),{modelValue:e(u).current_page,"onUpdate:modelValue":i[2]||(i[2]=s=>e(u).current_page=s),"total-rows":e(u).total,"per-page":e(u).per_page,onPageClick:S},null,8,["modelValue","total-rows","per-page"])])):v("",!0)])):(c(),m("div",$e,[o("p",Ee,a(e(t)("t-no-withdrawal-requests")),1)]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{Ke as default};
