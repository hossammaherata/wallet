import{Q as j,b as z,T as M,c as C,w as s,o as c,a as l,u as e,j as P,h as d,G as f,m as V,k as E,l as h,f as t,d as u,t as n,s as y,n as A,z as D,e as x,q as $,Y as I,V as Y,A as q,p as T,B as G,y as k}from"./app-p6nL2sIh.js";import{L as H}from"./main-DD0YxTIO.js";import{P as O}from"./page-header-D_lLMvKR.js";import{_ as B}from"./card-header-7vgZfBgl.js";import{S as v}from"./sweetalert2.all-G6W_N5Gt.js";import"./simplebar-vue.esm-Dfq80Hnp.js";import"./logo-dark-BbIT5rJd.js";import"./logo-light-BfYujB8V.js";import"./russia-pMTSjNGF.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={class:"mb-4 text-center"},J={key:0,class:"mb-3"},K=["src"],X={key:1,class:"mb-3"},Z=t("div",{class:"bg-light rounded-circle d-inline-flex align-items-center justify-content-center",style:{width:"150px",height:"150px"}},[t("i",{class:"ri-store-2-line",style:{"font-size":"3rem",color:"#999"}})],-1),ee=t("p",{class:"text-muted mt-2 small"},"No profile photo uploaded",-1),te=[Z,ee],se={class:"mb-3"},ae=t("label",{class:"form-label fw-semibold"},"Store Name",-1),le={class:"form-control-plaintext"},oe={class:"mb-3"},ne=t("label",{class:"form-label fw-semibold"},"Phone",-1),re={class:"form-control-plaintext"},de={class:"mb-3"},ie=t("label",{class:"form-label fw-semibold"},"Email Address",-1),ce={class:"form-control-plaintext"},ue={class:"mb-3"},_e=t("label",{class:"form-label fw-semibold"},"Status",-1),me={class:"form-control-plaintext"},fe={class:"mb-3"},pe=t("label",{class:"form-label fw-semibold"},"Created At",-1),be={class:"form-control-plaintext"},he={class:"mb-3"},ye=t("label",{class:"form-label fw-semibold"},"Last Updated",-1),ge={class:"form-control-plaintext"},ve={class:"mb-3"},we=t("label",{class:"form-label fw-semibold"},"Current Balance",-1),xe={class:"form-control-plaintext"},ke={class:"h4 text-primary fw-bold"},Se=t("small",{class:"text-muted"},"(Debt to Administration)",-1),Pe={class:"mb-3"},Ve=t("label",{class:"form-label fw-semibold"},"Wallet Status",-1),Ee={class:"d-flex align-items-center gap-2"},Ae=["value"],Be={class:"mb-3"},Ce=t("label",{class:"form-label fw-semibold"},"Record External Payment",-1),De=t("i",{class:"ri-money-dollar-circle-line me-1"},null,-1),Te={key:0},Ne={class:"mb-3"},Le={class:"text-muted"},Fe={class:"table-responsive"},Re={key:0},Ue={key:1},We=t("br",null,null,-1),je={class:"text-muted"},ze={key:0,class:"text-muted"},Me={key:1},$e=t("br",null,null,-1),Ie={class:"text-muted"},Ye={key:2,class:"text-muted"},qe={key:0,class:"ri-arrow-down-line text-success"},Ge={key:1,class:"ri-arrow-up-line text-danger"},He={key:0,class:"d-flex justify-content-center mt-3"},Oe={key:1,class:"text-center py-4"},Qe=t("p",{class:"text-muted"},"No transactions found",-1),Je=[Qe],Ke={class:"mb-3"},Xe=t("label",{class:"form-label"},[d("Amount "),t("span",{class:"text-danger"},"*")],-1),Ze={key:0,class:"text-danger small mt-1"},et={class:"mb-3"},tt=t("label",{class:"form-label"},"Note (Optional)",-1),st={class:"mb-3"},at={class:"text-muted"},lt=t("br",null,null,-1),ot={class:"d-flex justify-content-end gap-2"},nt={key:0},rt={key:1},gt={__name:"Show",setup(dt){const{store:o,transactions:p}=j().props;console.log("Store Data:",o),console.log("Profile Photo Path:",o.profile_photo_path),console.log("Profile Photo URL:",o.profile_photo_url);const g=z(!1),m=M({amount:"",note:""}),S=i=>i?new Date(i).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",w=i=>parseFloat(i||0).toFixed(2),N=i=>({success:"success",pending:"warning",failed:"danger"})[i]||"secondary",L=i=>({purchase:"primary",transfer:"info",credit:"success",debit:"danger",refund:"warning"})[i]||"secondary",F=()=>{if(!m.amount||parseFloat(m.amount)<=0){v.fire({icon:"error",title:"Error!",text:"Please enter a valid amount"});return}m.post(route("admin.stores.recordExternalPayment",o.id),{preserveState:!1,preserveScroll:!0,onSuccess:()=>{g.value=!1,m.reset(),v.fire({icon:"success",title:"Success!",text:"External payment recorded successfully",timer:2e3,showConfirmButton:!1}),k.reload()},onError:i=>{var r;v.fire({icon:"error",title:"Error!",text:i.message||((r=i.amount)==null?void 0:r[0])||"An error occurred while recording the payment"})}})},R=(i,r)=>{k.get(route("admin.stores.show",o.id),{page:r},{preserveState:!0})},U=i=>{const r=i.target,_=new FormData(r).get("status");k.post(route("admin.stores.updateWalletStatus",o.id),{status:_},{preserveState:!1,preserveScroll:!0,onSuccess:b=>{const W=_==="locked"?"Locked":"Active";v.fire({icon:"success",title:"Success!",text:`Wallet status updated to: ${W}`,timer:2e3,showConfirmButton:!1}),k.reload()},onError:b=>{v.fire({icon:"error",title:"Error!",text:b.message||"An error occurred while updating wallet status"})}})};return(i,r)=>(c(),C(H,null,{default:s(()=>[l(O,{title:"Store Details",pageTitle:"Stores Management",href:i.route("admin.stores.index")},{actions:s(()=>[l(e(P),{href:i.route("admin.stores.edit",e(o).id),class:"btn btn-warning me-2"},{default:s(()=>[d(" Edit Store ")]),_:1},8,["href"]),l(e(P),{href:i.route("admin.stores.index"),class:"btn btn-secondary"},{default:s(()=>[d(" Back to List ")]),_:1},8,["href"])]),_:1},8,["href"]),l(e(h),null,{default:s(()=>[l(e(f),{lg:"12"},{default:s(()=>[l(e(V),{"no-body":""},{default:s(()=>[l(B,{title:"Store Information"}),l(e(E),null,{default:s(()=>[l(e(h),null,{default:s(()=>[l(e(f),{md:"12"},{default:s(()=>[t("div",Q,[e(o).profile_photo_url?(c(),u("div",J,[t("img",{src:e(o).profile_photo_url,alt:"Profile Photo",class:"img-thumbnail rounded-circle",style:{width:"150px",height:"150px","object-fit":"cover"}},null,8,K)])):(c(),u("div",X,te))])]),_:1})]),_:1}),l(e(h),null,{default:s(()=>[l(e(f),{md:"6"},{default:s(()=>[t("div",se,[ae,t("p",le,n(e(o).name),1)])]),_:1}),l(e(f),{md:"6"},{default:s(()=>[t("div",oe,[ne,t("p",re,n(e(o).phone||"-"),1)])]),_:1})]),_:1}),l(e(h),null,{default:s(()=>[l(e(f),{md:"6"},{default:s(()=>[t("div",de,[ie,t("p",ce,n(e(o).email||"-"),1)])]),_:1}),l(e(f),{md:"6"},{default:s(()=>[t("div",ue,[_e,t("p",me,[l(e(y),{variant:e(o).status==="active"?"success":"danger"},{default:s(()=>[d(n(e(o).status||"N/A"),1)]),_:1},8,["variant"])])])]),_:1})]),_:1}),l(e(h),null,{default:s(()=>[l(e(f),{md:"6"},{default:s(()=>[t("div",fe,[pe,t("p",be,n(S(e(o).created_at)),1)])]),_:1}),l(e(f),{md:"6"},{default:s(()=>[t("div",he,[ye,t("p",ge,n(S(e(o).updated_at)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(e(h),{class:"mt-4"},{default:s(()=>[l(e(f),{lg:"12"},{default:s(()=>[l(e(V),{"no-body":""},{default:s(()=>[l(B,{title:"Wallet Information"}),l(e(E),null,{default:s(()=>[l(e(h),null,{default:s(()=>[l(e(f),{md:"4"},{default:s(()=>{var a;return[t("div",ve,[we,t("p",xe,[t("span",ke,n(w(((a=e(o).wallet)==null?void 0:a.balance)||0))+" Points ",1)]),Se])]}),_:1}),l(e(f),{md:"4"},{default:s(()=>{var a;return[t("div",Pe,[Ve,t("div",Ee,[l(e(y),{variant:((a=e(o).wallet)==null?void 0:a.status)==="active"?"success":"danger"},{default:s(()=>{var _,b;return[d(n(((_=e(o).wallet)==null?void 0:_.status)==="active"?"Active":((b=e(o).wallet)==null?void 0:b.status)==="locked"?"Locked":"N/A"),1)]}),_:1},8,["variant"]),e(o).wallet?(c(),u("form",{key:0,onSubmit:D(U,["prevent"]),class:"d-inline"},[t("input",{type:"hidden",name:"status",value:e(o).wallet.status==="active"?"locked":"active"},null,8,Ae),t("button",{type:"submit",class:A(["btn btn-sm",e(o).wallet.status==="active"?"btn-warning":"btn-success"])},[t("i",{class:A(e(o).wallet.status==="active"?"ri-lock-line":"ri-lock-unlock-line")},null,2),d(" "+n(e(o).wallet.status==="active"?"Lock Wallet":"Unlock Wallet"),1)],2)],32)):x("",!0)])])]}),_:1}),l(e(f),{md:"4"},{default:s(()=>[t("div",Be,[Ce,t("div",null,[t("button",{type:"button",class:"btn btn-primary",onClick:r[0]||(r[0]=a=>g.value=!0)},[De,d(" Record Payment ")])])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(e(h),{class:"mt-4"},{default:s(()=>[l(e(f),{lg:"12"},{default:s(()=>[l(e(V),{"no-body":""},{default:s(()=>[l(B,{title:"Transactions History"}),l(e(E),null,{default:s(()=>[e(p)&&e(p).data&&e(p).data.length>0?(c(),u("div",Te,[t("div",Ne,[t("span",Le,[d("Total Transactions: "),t("strong",null,n(e(p).total),1)])]),t("div",Fe,[l(e($),{striped:"",hover:"",items:e(p).data,fields:[{key:"row_number",label:"#",sortable:!1},{key:"reference_id",label:"Reference ID",sortable:!0},{key:"from_user",label:"From",sortable:!1},{key:"to_user",label:"To",sortable:!1},{key:"amount",label:"Amount",sortable:!0},{key:"type",label:"Type",sortable:!0},{key:"status",label:"Status",sortable:!0},{key:"created_at",label:"Date",sortable:!0},{key:"actions",label:"Actions"}],class:"table-nowrap"},{"cell(row_number)":s(({index:a})=>[d(n((e(p).current_page-1)*e(p).per_page+a+1),1)]),"cell(reference_id)":s(({item:a})=>[t("code",null,n(a.reference_id),1)]),"cell(from_user)":s(({item:a})=>{var _;return[a.type==="debit"&&a.meta&&a.meta.payment_type==="external"?(c(),u("span",Re,[l(e(y),{variant:"warning"},{default:s(()=>[d("External Payment")]),_:1})])):(_=a.from_wallet)!=null&&_.user?(c(),u("span",Ue,[d(n(a.from_wallet.user.name),1),We,t("small",je,n(a.from_wallet.user.phone),1)])):(c(),C(e(y),{key:2,variant:"secondary"},{default:s(()=>[d("SYSTEM")]),_:1}))]}),"cell(to_user)":s(({item:a})=>{var _;return[a.type==="debit"&&a.meta&&a.meta.payment_type==="external"?(c(),u("span",ze," - ")):(_=a.to_wallet)!=null&&_.user?(c(),u("span",Me,[d(n(a.to_wallet.user.name),1),$e,t("small",Ie,n(a.to_wallet.user.phone),1)])):(c(),u("span",Ye,"-"))]}),"cell(amount)":s(({item:a})=>[t("span",{class:A(["fw-bold",{"text-success":a.is_credit,"text-danger":a.is_debit}])},[a.is_credit?(c(),u("i",qe)):a.is_debit?(c(),u("i",Ge)):x("",!0),d(" "+n(a.display_amount||w(a.amount))+" Points ",1)],2)]),"cell(type)":s(({item:a})=>[l(e(y),{variant:L(a.type)},{default:s(()=>[d(n(a.type),1)]),_:2},1032,["variant"])]),"cell(status)":s(({item:a})=>[l(e(y),{variant:N(a.status)},{default:s(()=>[d(n(a.status),1)]),_:2},1032,["variant"])]),"cell(created_at)":s(({item:a})=>[d(n(S(a.created_at)),1)]),"cell(actions)":s(({item:a})=>[l(e(P),{href:i.route("admin.transactions.show",a.id),class:"btn btn-info btn-sm"},{default:s(()=>[d(" View ")]),_:2},1032,["href"])]),_:1},8,["items"])]),e(p).last_page>1?(c(),u("div",He,[l(e(I),{modelValue:e(p).current_page,"onUpdate:modelValue":r[1]||(r[1]=a=>e(p).current_page=a),"total-rows":e(p).total,"per-page":e(p).per_page,onPageClick:R},null,8,["modelValue","total-rows","per-page"])])):x("",!0)])):(c(),u("div",Oe,Je))]),_:1})]),_:1})]),_:1})]),_:1}),l(e(G),{modelValue:g.value,"onUpdate:modelValue":r[5]||(r[5]=a=>g.value=a),title:"Record External Payment","hide-footer":"",size:"md"},{default:s(()=>{var a,_;return[t("form",{onSubmit:D(F,["prevent"])},[t("div",Ke,[Xe,l(e(Y),{modelValue:e(m).amount,"onUpdate:modelValue":r[2]||(r[2]=b=>e(m).amount=b),type:"number",step:"0.01",min:"0.01",placeholder:"Enter amount",required:""},null,8,["modelValue"]),e(m).errors.amount?(c(),u("div",Ze,n(e(m).errors.amount),1)):x("",!0)]),t("div",et,[tt,l(e(q),{modelValue:e(m).note,"onUpdate:modelValue":r[3]||(r[3]=b=>e(m).note=b),rows:"3",placeholder:"Enter a note about the payment"},null,8,["modelValue"])]),t("div",st,[t("small",at,[d(" Current Balance: "),t("strong",null,n(w(((a=e(o).wallet)==null?void 0:a.balance)||0))+" Points",1),lt,d(" After Payment: "),t("strong",null,n(w((((_=e(o).wallet)==null?void 0:_.balance)||0)-(parseFloat(e(m).amount)||0)))+" Points",1)])]),t("div",ot,[l(e(T),{variant:"secondary",onClick:r[4]||(r[4]=b=>g.value=!1)},{default:s(()=>[d(" Cancel ")]),_:1}),l(e(T),{variant:"primary",type:"submit",disabled:e(m).processing},{default:s(()=>[e(m).processing?(c(),u("span",nt,"Recording...")):(c(),u("span",rt,"Record Payment"))]),_:1},8,["disabled"])])],32)]}),_:1},8,["modelValue"])]),_:1}))}};export{gt as default};
