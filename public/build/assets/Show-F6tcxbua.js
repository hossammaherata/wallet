import{x as q,Q as G,b as M,T as R,c as E,w as l,o as u,a as n,u as t,j as P,h as d,t as a,G as f,m as B,k as C,l as y,f as s,d as _,s as g,n as D,A as N,e as k,q as W,Y,V as H,B as I,p as T,C as Q,z as S}from"./app-CcTRj-1j.js";import{L as J}from"./main-BoIr1UXL.js";import{P as K}from"./page-header-CdDAVjNy.js";import{_ as F}from"./card-header-DtMv4YzG.js";import{S as w}from"./sweetalert2.all-D7X0Wwb8.js";import"./simplebar-vue.esm-Cj-VXA2q.js";import"./logo-dark-BbIT5rJd.js";import"./logo-light-BfYujB8V.js";import"./us-DIspYScJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"mb-4 text-center"},X={key:0,class:"mb-3"},Z=["src"],tt={key:1,class:"mb-3"},et=s("div",{class:"bg-light rounded-circle d-inline-flex align-items-center justify-content-center",style:{width:"150px",height:"150px"}},[s("i",{class:"ri-store-2-line",style:{"font-size":"3rem",color:"#999"}})],-1),st={class:"text-muted mt-2 small"},at={class:"mb-3"},lt={class:"form-label fw-semibold"},ot={class:"form-control-plaintext"},nt={class:"mb-3"},rt={class:"form-label fw-semibold"},it={class:"form-control-plaintext"},dt={class:"mb-3"},ct={class:"form-label fw-semibold"},ut={class:"form-control-plaintext"},_t={class:"mb-3"},mt={class:"form-label fw-semibold"},pt={class:"form-control-plaintext"},ft={class:"mb-3"},bt={class:"form-label fw-semibold"},ht={class:"form-control-plaintext"},yt={class:"mb-3"},gt={class:"form-label fw-semibold"},vt={class:"form-control-plaintext"},wt={class:"mb-3"},xt={class:"form-label fw-semibold"},kt={class:"form-control-plaintext"},St={class:"h4 text-primary fw-bold"},Vt={class:"text-muted"},Pt={class:"mb-3"},Bt={class:"form-label fw-semibold"},Ct={class:"d-flex align-items-center gap-2"},Dt=["value"],Ft={class:"mb-3"},Et={class:"form-label fw-semibold"},Nt=s("i",{class:"ri-money-dollar-circle-line me-1"},null,-1),Tt={key:0},Ut={class:"mb-3"},jt={class:"text-muted"},$t={class:"table-responsive"},zt={key:0},At={key:1},Lt=s("br",null,null,-1),qt={class:"text-muted"},Gt={key:0,class:"text-muted"},Mt={key:1},Rt=s("br",null,null,-1),Wt={class:"text-muted"},Yt={key:2,class:"text-muted"},Ht={key:0,class:"ri-arrow-down-line text-success"},It={key:1,class:"ri-arrow-up-line text-danger"},Qt={key:0,class:"d-flex justify-content-center mt-3"},Jt={key:1,class:"text-center py-4"},Kt={class:"text-muted"},Ot={class:"mb-3"},Xt={class:"form-label"},Zt=s("span",{class:"text-danger"},"*",-1),te={key:0,class:"text-danger small mt-1"},ee={class:"mb-3"},se={class:"form-label"},ae={class:"mb-3"},le={class:"text-muted"},oe=s("br",null,null,-1),ne={class:"d-flex justify-content-end gap-2"},re={key:0},ie={key:1},ve={__name:"Show",setup(de){const{t:e}=q(),{store:r,transactions:b}=G().props;console.log("Store Data:",r),console.log("Profile Photo Path:",r.profile_photo_path),console.log("Profile Photo URL:",r.profile_photo_url);const v=M(!1),p=R({amount:"",note:""}),V=c=>c?new Date(c).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"-",x=c=>parseFloat(c||0).toFixed(2),U=c=>({success:"success",pending:"warning",failed:"danger"})[c]||"secondary",j=c=>({purchase:"primary",transfer:"info",credit:"success",debit:"danger",refund:"warning"})[c]||"secondary",$=()=>{if(!p.amount||parseFloat(p.amount)<=0){w.fire({icon:"error",title:e("t-error"),text:e("t-please-enter-valid-amount")});return}p.post(route("admin.stores.recordExternalPayment",r.id),{preserveState:!1,preserveScroll:!0,onSuccess:()=>{v.value=!1,p.reset(),w.fire({icon:"success",title:e("t-success"),text:e("t-external-payment-recorded"),timer:2e3,showConfirmButton:!1}),S.reload()},onError:c=>{var i;w.fire({icon:"error",title:e("t-error"),text:c.message||((i=c.amount)==null?void 0:i[0])||e("t-an-error-occurred")})}})},z=(c,i)=>{S.get(route("admin.stores.show",r.id),{page:i},{preserveState:!0})},A=c=>{const i=c.target,m=new FormData(i).get("status");S.post(route("admin.stores.updateWalletStatus",r.id),{status:m},{preserveState:!1,preserveScroll:!0,onSuccess:h=>{const L=e(m==="locked"?"t-locked":"t-active");w.fire({icon:"success",title:e("t-success"),text:`${e("t-wallet-status-updated")} ${L}`,timer:2e3,showConfirmButton:!1}),S.reload()},onError:h=>{w.fire({icon:"error",title:e("t-error"),text:h.message||e("t-an-error-occurred")})}})};return(c,i)=>(u(),E(J,null,{default:l(()=>[n(K,{title:t(e)("t-store-details"),pageTitle:t(e)("t-stores-management"),href:c.route("admin.stores.index")},{actions:l(()=>[n(t(P),{href:c.route("admin.stores.edit",t(r).id),class:"btn btn-warning me-2"},{default:l(()=>[d(a(t(e)("t-edit-store")),1)]),_:1},8,["href"]),n(t(P),{href:c.route("admin.stores.index"),class:"btn btn-secondary"},{default:l(()=>[d(a(t(e)("t-back-to-list")),1)]),_:1},8,["href"])]),_:1},8,["title","pageTitle","href"]),n(t(y),null,{default:l(()=>[n(t(f),{lg:"12"},{default:l(()=>[n(t(B),{"no-body":""},{default:l(()=>[n(F,{title:t(e)("t-store-information")},null,8,["title"]),n(t(C),null,{default:l(()=>[n(t(y),null,{default:l(()=>[n(t(f),{md:"12"},{default:l(()=>[s("div",O,[t(r).profile_photo_url?(u(),_("div",X,[s("img",{src:t(r).profile_photo_url,alt:"Profile Photo",class:"img-thumbnail rounded-circle",style:{width:"150px",height:"150px","object-fit":"cover"}},null,8,Z)])):(u(),_("div",tt,[et,s("p",st,a(t(e)("t-no-profile-photo")),1)]))])]),_:1})]),_:1}),n(t(y),null,{default:l(()=>[n(t(f),{md:"6"},{default:l(()=>[s("div",at,[s("label",lt,a(t(e)("t-store-name")),1),s("p",ot,a(t(r).name),1)])]),_:1}),n(t(f),{md:"6"},{default:l(()=>[s("div",nt,[s("label",rt,a(t(e)("t-phone")),1),s("p",it,a(t(r).phone||"-"),1)])]),_:1})]),_:1}),n(t(y),null,{default:l(()=>[n(t(f),{md:"6"},{default:l(()=>[s("div",dt,[s("label",ct,a(t(e)("t-email-address")),1),s("p",ut,a(t(r).email||"-"),1)])]),_:1}),n(t(f),{md:"6"},{default:l(()=>[s("div",_t,[s("label",mt,a(t(e)("t-status")),1),s("p",pt,[n(t(g),{variant:t(r).status==="active"?"success":"danger"},{default:l(()=>[d(a(t(r).status||"N/A"),1)]),_:1},8,["variant"])])])]),_:1})]),_:1}),n(t(y),null,{default:l(()=>[n(t(f),{md:"6"},{default:l(()=>[s("div",ft,[s("label",bt,a(t(e)("t-created-at")),1),s("p",ht,a(V(t(r).created_at)),1)])]),_:1}),n(t(f),{md:"6"},{default:l(()=>[s("div",yt,[s("label",gt,a(t(e)("t-last-updated")),1),s("p",vt,a(V(t(r).updated_at)),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(t(y),{class:"mt-4"},{default:l(()=>[n(t(f),{lg:"12"},{default:l(()=>[n(t(B),{"no-body":""},{default:l(()=>[n(F,{title:t(e)("t-wallet-information")},null,8,["title"]),n(t(C),null,{default:l(()=>[n(t(y),null,{default:l(()=>[n(t(f),{md:"4"},{default:l(()=>{var o;return[s("div",wt,[s("label",xt,a(t(e)("t-current-balance")),1),s("p",kt,[s("span",St,a(x(((o=t(r).wallet)==null?void 0:o.balance)||0))+" "+a(t(e)("t-points")),1)]),s("small",Vt,a(t(e)("t-debt-to-administration")),1)])]}),_:1}),n(t(f),{md:"4"},{default:l(()=>{var o;return[s("div",Pt,[s("label",Bt,a(t(e)("t-wallet-status")),1),s("div",Ct,[n(t(g),{variant:((o=t(r).wallet)==null?void 0:o.status)==="active"?"success":"danger"},{default:l(()=>{var m,h;return[d(a(((m=t(r).wallet)==null?void 0:m.status)==="active"?t(e)("t-active"):((h=t(r).wallet)==null?void 0:h.status)==="locked"?t(e)("t-locked"):"N/A"),1)]}),_:1},8,["variant"]),t(r).wallet?(u(),_("form",{key:0,onSubmit:N(A,["prevent"]),class:"d-inline"},[s("input",{type:"hidden",name:"status",value:t(r).wallet.status==="active"?"locked":"active"},null,8,Dt),s("button",{type:"submit",class:D(["btn btn-sm",t(r).wallet.status==="active"?"btn-warning":"btn-success"])},[s("i",{class:D(t(r).wallet.status==="active"?"ri-lock-line":"ri-lock-unlock-line")},null,2),d(" "+a(t(r).wallet.status==="active"?t(e)("t-lock-wallet"):t(e)("t-unlock-wallet")),1)],2)],32)):k("",!0)])])]}),_:1}),n(t(f),{md:"4"},{default:l(()=>[s("div",Ft,[s("label",Et,a(t(e)("t-record-external-payment")),1),s("div",null,[s("button",{type:"button",class:"btn btn-primary",onClick:i[0]||(i[0]=o=>v.value=!0)},[Nt,d(" "+a(t(e)("t-record-payment")),1)])])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n(t(y),{class:"mt-4"},{default:l(()=>[n(t(f),{lg:"12"},{default:l(()=>[n(t(B),{"no-body":""},{default:l(()=>[n(F,{title:t(e)("t-transactions-history")},null,8,["title"]),n(t(C),null,{default:l(()=>[t(b)&&t(b).data&&t(b).data.length>0?(u(),_("div",Tt,[s("div",Ut,[s("span",jt,[d(a(t(e)("t-total-transactions"))+": ",1),s("strong",null,a(t(b).total),1)])]),s("div",$t,[n(t(W),{striped:"",hover:"",items:t(b).data,fields:[{key:"row_number",label:"#",sortable:!1},{key:"reference_id",label:t(e)("t-reference-id"),sortable:!0},{key:"from_user",label:t(e)("t-from"),sortable:!1},{key:"to_user",label:t(e)("t-to"),sortable:!1},{key:"amount",label:t(e)("t-amount"),sortable:!0},{key:"type",label:t(e)("t-type"),sortable:!0},{key:"status",label:t(e)("t-status"),sortable:!0},{key:"created_at",label:t(e)("t-date"),sortable:!0},{key:"actions",label:t(e)("t-actions")}],class:"table-nowrap"},{"cell(row_number)":l(({index:o})=>[d(a((t(b).current_page-1)*t(b).per_page+o+1),1)]),"cell(reference_id)":l(({item:o})=>[s("code",null,a(o.reference_id),1)]),"cell(from_user)":l(({item:o})=>{var m;return[o.type==="debit"&&o.meta&&o.meta.payment_type==="external"?(u(),_("span",zt,[n(t(g),{variant:"warning"},{default:l(()=>[d(a(t(e)("t-external-payment")),1)]),_:1})])):(m=o.from_wallet)!=null&&m.user?(u(),_("span",At,[d(a(o.from_wallet.user.name),1),Lt,s("small",qt,a(o.from_wallet.user.phone),1)])):(u(),E(t(g),{key:2,variant:"secondary"},{default:l(()=>[d(a(t(e)("t-system")),1)]),_:1}))]}),"cell(to_user)":l(({item:o})=>{var m;return[o.type==="debit"&&o.meta&&o.meta.payment_type==="external"?(u(),_("span",Gt," - ")):(m=o.to_wallet)!=null&&m.user?(u(),_("span",Mt,[d(a(o.to_wallet.user.name),1),Rt,s("small",Wt,a(o.to_wallet.user.phone),1)])):(u(),_("span",Yt,"-"))]}),"cell(amount)":l(({item:o})=>[s("span",{class:D(["fw-bold",{"text-success":o.is_credit,"text-danger":o.is_debit}])},[o.is_credit?(u(),_("i",Ht)):o.is_debit?(u(),_("i",It)):k("",!0),d(" "+a(o.display_amount||x(o.amount))+" "+a(t(e)("t-points")),1)],2)]),"cell(type)":l(({item:o})=>[n(t(g),{variant:j(o.type)},{default:l(()=>[d(a(o.type),1)]),_:2},1032,["variant"])]),"cell(status)":l(({item:o})=>[n(t(g),{variant:U(o.status)},{default:l(()=>[d(a(o.status),1)]),_:2},1032,["variant"])]),"cell(created_at)":l(({item:o})=>[d(a(V(o.created_at)),1)]),"cell(actions)":l(({item:o})=>[n(t(P),{href:c.route("admin.transactions.show",o.id),class:"btn btn-info btn-sm"},{default:l(()=>[d(a(t(e)("t-view")),1)]),_:2},1032,["href"])]),_:1},8,["items","fields"])]),t(b).last_page>1?(u(),_("div",Qt,[n(t(Y),{modelValue:t(b).current_page,"onUpdate:modelValue":i[1]||(i[1]=o=>t(b).current_page=o),"total-rows":t(b).total,"per-page":t(b).per_page,onPageClick:z},null,8,["modelValue","total-rows","per-page"])])):k("",!0)])):(u(),_("div",Jt,[s("p",Kt,a(t(e)("t-no-transactions-found")),1)]))]),_:1})]),_:1})]),_:1})]),_:1}),n(t(Q),{modelValue:v.value,"onUpdate:modelValue":i[5]||(i[5]=o=>v.value=o),title:t(e)("t-record-external-payment"),"hide-footer":"",size:"md"},{default:l(()=>{var o,m;return[s("form",{onSubmit:N($,["prevent"])},[s("div",Ot,[s("label",Xt,[d(a(t(e)("t-amount"))+" ",1),Zt]),n(t(H),{modelValue:t(p).amount,"onUpdate:modelValue":i[2]||(i[2]=h=>t(p).amount=h),type:"number",step:"0.01",min:"0.01",placeholder:t(e)("t-enter-amount"),required:""},null,8,["modelValue","placeholder"]),t(p).errors.amount?(u(),_("div",te,a(t(p).errors.amount),1)):k("",!0)]),s("div",ee,[s("label",se,a(t(e)("t-note-optional")),1),n(t(I),{modelValue:t(p).note,"onUpdate:modelValue":i[3]||(i[3]=h=>t(p).note=h),rows:"3",placeholder:t(e)("t-enter-note-about-payment")},null,8,["modelValue","placeholder"])]),s("div",ae,[s("small",le,[d(a(t(e)("t-current-balance"))+": ",1),s("strong",null,a(x(((o=t(r).wallet)==null?void 0:o.balance)||0))+" "+a(t(e)("t-points")),1),oe,d(" "+a(t(e)("t-after-payment"))+": ",1),s("strong",null,a(x((((m=t(r).wallet)==null?void 0:m.balance)||0)-(parseFloat(t(p).amount)||0)))+" "+a(t(e)("t-points")),1)])]),s("div",ne,[n(t(T),{variant:"secondary",onClick:i[4]||(i[4]=h=>v.value=!1)},{default:l(()=>[d(a(t(e)("t-cancel")),1)]),_:1}),n(t(T),{variant:"primary",type:"submit",disabled:t(p).processing},{default:l(()=>[t(p).processing?(u(),_("span",re,a(t(e)("t-recording")),1)):(u(),_("span",ie,a(t(e)("t-record-payment")),1))]),_:1},8,["disabled"])])],32)]}),_:1},8,["modelValue","title"])]),_:1}))}};export{ve as default};
